<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.iidooo.framework.dao.extend.FieldDataDao">
	<resultMap id="BaseResultMap" type="com.iidooo.framework.dto.extend.FieldDataDto">
		<id column="DataID" property="dataID" jdbcType="INTEGER" />
		<result column="FieldID" property="fieldID" jdbcType="INTEGER" />
		<result column="TableDataID" property="tableDataID" jdbcType="INTEGER" />
		<result column="FieldValue" property="fieldValue" jdbcType="VARCHAR" />
		<result column="Remarks" property="remarks" jdbcType="VARCHAR" />
		<result column="CreateTime" property="createTime" jdbcType="VARCHAR" />
		<result column="CreateUser" property="createUser" jdbcType="INTEGER" />
		<result column="UpdateTime" property="updateTime" jdbcType="VARCHAR" />
		<result column="UpdateUser" property="updateUser" jdbcType="INTEGER" />
		<result column="IsDelete" property="isDelete" jdbcType="INTEGER" />
		<result column="Version" property="version" jdbcType="INTEGER" />
	</resultMap>
	<sql id="Base_Column_List">
		DataID, FieldID, TableDataID, FieldValue, Remarks, CreateTime, CreateUser, UpdateTime,
		UpdateUser, IsDelete, Version
	</sql>
	<select id="selectFieldDataList" resultMap="BaseResultMap" parameterType="com.iidooo.framework.dto.extend.FieldConfigDto">
		select
		<include refid="Base_Column_List" />
		from IDO_FIELD_DATA
		where IsDelete = 0 and TableDataID = #{tableDataID,jdbcType=INTEGER} and FieldID in
		<foreach item="item" index="index" collection="fieldConfigs" open="(" separator="," close=")">#{item.fieldID}</foreach>

	</select>

	<insert id="insert" useGeneratedKeys="true" keyProperty="dataID" parameterType="com.iidooo.framework.dto.extend.FieldDataDto">
		insert into IDO_FIELD_DATA (FieldID, TableDataID,
		FieldValue,
		Remarks, CreateTime,
		CreateUser, UpdateTime, UpdateUser,
		IsDelete, Version)
		values (#{fieldID,jdbcType=INTEGER}, #{tableDataID,jdbcType=INTEGER},
		#{fieldValue,jdbcType=VARCHAR}, #{remarks,jdbcType=VARCHAR}, #{createTime,jdbcType=VARCHAR},
		#{createUser,jdbcType=INTEGER},
		#{updateTime,jdbcType=VARCHAR}, #{updateUser,jdbcType=INTEGER}, 0, 1)
	</insert>

	<update id="updateByPrimaryKey" parameterType="com.iidooo.framework.dto.extend.FieldDataDto">
		update IDO_FIELD_DATA
		set FieldID = #{fieldID,jdbcType=INTEGER},
		TableDataID =
		#{tableDataID,jdbcType=INTEGER},
		FieldValue = #{fieldValue,jdbcType=VARCHAR},
		Remarks = #{remarks,jdbcType=VARCHAR},
		UpdateTime =
		#{updateTime,jdbcType=VARCHAR},
		UpdateUser = #{updateUser,jdbcType=INTEGER},
		Version = Version ＋ 1
		where DataID = #{dataID,jdbcType=INTEGER}
	</update>
	
	<update id="deleteByPrimaryKey" parameterType="com.iidooo.framework.dto.extend.FieldDataDto">
		update IDO_FIELD_DATA
		set 
		UpdateTime = #{updateTime,jdbcType=VARCHAR},
		UpdateUser = #{updateUser,jdbcType=INTEGER},
		IsDelete = 1,
		Version = Version ＋ 1
		where DataID = #{dataID,jdbcType=INTEGER}
	</update>
</mapper>