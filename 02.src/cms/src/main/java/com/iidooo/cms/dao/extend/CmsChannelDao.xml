<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.iidooo.cms.dao.extend.CmsChannelDao">
	<resultMap id="BaseResultMap" type="com.iidooo.cms.dto.extend.CmsChannelDto">
		<id column="ChannelID" property="channelID" jdbcType="INTEGER" />
		<result column="TemplateID" property="templateID" jdbcType="INTEGER" />
		<result column="ParentID" property="parentID" jdbcType="INTEGER" />
		<result column="ChannelName" property="channelName" jdbcType="VARCHAR" />
		<result column="ChannelPath" property="channelPath" jdbcType="VARCHAR" />
		<result column="MetaTitle" property="metaTitle" jdbcType="VARCHAR" />
		<result column="metaKeywords" property="metaKeywords" jdbcType="VARCHAR" />
		<result column="MetaDescription" property="metaDescription" jdbcType="VARCHAR" />
		<result column="Sequence" property="sequence" jdbcType="INTEGER" />
		<result column="IsHidden" property="isHidden" jdbcType="INTEGER" />
		<result column="ExternalURL" property="externalURL" jdbcType="VARCHAR" />
		<result column="Remarks" property="remarks" jdbcType="VARCHAR" />
		<result column="CreateTime" property="createTime" jdbcType="VARCHAR" />
		<result column="CreateUser" property="createUser" jdbcType="INTEGER" />
		<result column="UpdateTime" property="updateTime" jdbcType="VARCHAR" />
		<result column="UpdateUser" property="updateUser" jdbcType="INTEGER" />
		<result column="IsDelete" property="isDelete" jdbcType="INTEGER" />
		<result column="Version" property="version" jdbcType="INTEGER" />
	</resultMap>
	<sql id="Base_Column_List">
		C.ChannelID, C.TemplateID, C.ParentID, C.ChannelName, C.ChannelPath, C.MetaTitle,
		C.MetaKeywords,
		C.MetaDescription, C.Sequence, C.IsHidden, C.ExternalURL, C.Remarks, C.CreateTime,
		C.CreateUser, C.UpdateTime, C.UpdateUser, C.IsDelete, C.Version
	</sql>
	<select id="selectChannelByPath" resultMap="BaseResultMap" parameterType="java.lang.String">
		select
		<include refid="Base_Column_List" />, T.TemplatePath
		from IDO_CMS_CHANNEL C
		inner join IDO_CMS_TEMPLATE T on C.TemplateID = T.TemplateID and C.IsDelete = 0 and T.IsDelete = 0
		and C.ChannelPath = #{channelPath,jdbcType=VARCHAR}
	</select>
	<select id="selectChannelByID" resultMap="BaseResultMap" parameterType="java.lang.Integer">
		select
		<include refid="Base_Column_List" />, T.TemplatePath
		from IDO_CMS_CHANNEL C
		inner join IDO_CMS_TEMPLATE T on C.TemplateID = T.TemplateID and C.IsDelete = 0 and T.IsDelete = 0
		and C.ChannelID =
		#{channelID,jdbcType=INTEGER}
	</select>
	<select id="selectAllChannels" resultMap="BaseResultMap" parameterType="java.lang.Integer">
		select
		<include refid="Base_Column_List" />, T.TemplatePath
		from IDO_CMS_CHANNEL C
		inner join IDO_CMS_TEMPLATE T on C.TemplateID = T.TemplateID and C.IsDelete = 0 and T.IsDelete = 0
	</select>
	
	<select id="selectChannelsByParentID" resultMap="BaseResultMap" parameterType="java.lang.Integer">
		select
		<include refid="Base_Column_List" />
		from IDO_CMS_CHANNEL C where C.ParentID = #{parentID,jdbcType=INTEGER} and C.IsDelete = 0 order by C.Sequence
	</select>
	
	<select id="selectTopChannels" resultMap="BaseResultMap" parameterType="java.util.Map">
		select
		<include refid="Base_Column_List" />, T.TemplatePath
		from IDO_CMS_CHANNEL C
		inner join IDO_CMS_TEMPLATE T
		on C.TemplateID = T.TemplateID and C.ParentID = 0 and C.IsDelete = 0 and T.IsDelete = 0
		order by C.${sortBy} ${sortType}
	</select>
	
	<insert id="insert" parameterType="com.iidooo.cms.dto.extend.CmsChannelDto" >
    insert into IDO_CMS_CHANNEL C (<include refid="Base_Column_List" />)
    values (#{templateID,jdbcType=INTEGER}, #{parentID,jdbcType=INTEGER}, 
      #{channelName,jdbcType=VARCHAR}, #{channelPath,jdbcType=VARCHAR}, #{metaTitle,jdbcType=VARCHAR}, 
      #{metaKeywords,jdbcType=VARCHAR}, #{metaDescription,jdbcType=VARCHAR}, #{sequence,jdbcType=INTEGER}, 
      #{isHidden,jdbcType=INTEGER}, #{externalURL,jdbcType=VARCHAR}, #{remarks,jdbcType=VARCHAR}, 
      #{createTime,jdbcType=VARCHAR}, #{createUser,jdbcType=INTEGER}, #{updateTime,jdbcType=VARCHAR}, 
      #{updateUser,jdbcType=INTEGER}, #{isDelete,jdbcType=INTEGER}, #{version,jdbcType=INTEGER}
      )
  </insert>
	
</mapper>