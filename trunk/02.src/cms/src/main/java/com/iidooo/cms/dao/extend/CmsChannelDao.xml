<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.iidooo.cms.dao.extend.CmsChannelDao">
	<resultMap id="BaseResultMap" type="com.iidooo.cms.dto.extend.CmsChannelDto">
		<id column="ChannelID" property="channelID" jdbcType="INTEGER" />
		<result column="ParentID" property="parentID" jdbcType="INTEGER" />
		<result column="ChannelName" property="channelName" jdbcType="VARCHAR" />
		<result column="ChannelPath" property="channelPath" jdbcType="VARCHAR" />
		<result column="ChannelLevel" property="channelLevel" jdbcType="INTEGER" />
		<result column="MetaTitle" property="metaTitle" jdbcType="VARCHAR" />
		<result column="MetaKeywords" property="metaKeywords" jdbcType="VARCHAR" />
		<result column="MetaDescription" property="metaDescription" jdbcType="VARCHAR" />
		<result column="Sequence" property="sequence" jdbcType="INTEGER" />
		<result column="IsHidden" property="isHidden" jdbcType="CHAR" />
		<result column="Remarks" property="remarks" jdbcType="VARCHAR" />
		<result column="CreateTime" property="createTime" jdbcType="VARCHAR" />
		<result column="CreateUser" property="createUser" jdbcType="INTEGER" />
		<result column="UpdateTime" property="updateTime" jdbcType="VARCHAR" />
		<result column="UpdateUser" property="updateUser" jdbcType="INTEGER" />
		<result column="IsDelete" property="isDelete" jdbcType="INTEGER" />
		<result column="Version" property="version" jdbcType="INTEGER" />
	</resultMap>
	<sql id="Base_Column_List">
		C.ChannelID, C.ParentID, C.ChannelName, C.ChannelPath, C.ChannelLevel, C.MetaTitle,
		C.MetaKeywords,
		C.MetaDescription,
		C.Sequence,
		C.IsHidden, C.Remarks, C.CreateTime,
		C.CreateUser, C.UpdateTime, C.UpdateUser, C.IsDelete, C.Version
	</sql>
	<select id="selectChannelByPath" resultMap="BaseResultMap" parameterType="java.lang.String">
		select
		<include refid="Base_Column_List" />		
		from IDO_CMS_CHANNEL C
		where C.IsDelete = 0 and
		C.ChannelPath = #{channelPath,jdbcType=VARCHAR}
	</select>
	<select id="selectChannelByID" resultMap="BaseResultMap" parameterType="java.lang.Integer">
		select
		<include refid="Base_Column_List" />
		from IDO_CMS_CHANNEL C
		where C.IsDelete = 0 and
		C.ChannelID = #{channelID,jdbcType=INTEGER}
	</select>
	<select id="selectAll" resultMap="BaseResultMap" parameterType="java.lang.Integer">
		select
		<include refid="Base_Column_List" />
		from IDO_CMS_CHANNEL C
		where C.IsDelete = 0 
	</select>

	<select id="selectByParentID" resultMap="BaseResultMap" parameterType="java.lang.Integer">
		select
		<include refid="Base_Column_List" />
		from IDO_CMS_CHANNEL C where C.ParentID = #{parentID,jdbcType=INTEGER} and C.IsDelete = 0 order by C.Sequence
	</select>

	<select id="exclusiveCheck" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from IDO_CMS_CHANNEL C
		where C.IsDelete = 0 and C.ChannelID = #{0} and C.Version = #{1}
	</select>

	<insert id="insert" useGeneratedKeys="true" keyProperty="channelID" parameterType="com.iidooo.cms.dto.extend.CmsChannelDto">
		insert into IDO_CMS_CHANNEL (
		ParentID,
		ChannelName, ChannelPath, ChannelLevel,
		MetaTitle,
		MetaKeywords,
		MetaDescription,
		Sequence,
		IsHidden, Remarks, CreateTime,
		CreateUser, UpdateTime,
		UpdateUser, IsDelete,
		Version
		)
		values
		(#{parentID,jdbcType=INTEGER},
		#{channelName,jdbcType=VARCHAR},
		#{channelPath,jdbcType=VARCHAR},
		#{channelLevel,jdbcType=INTEGER},#{metaTitle,jdbcType=VARCHAR},
		#{metaKeywords,jdbcType=VARCHAR},
		#{metaDescription,jdbcType=VARCHAR},
		#{sequence,jdbcType=INTEGER}, #{isHidden,jdbcType=CHAR},
		#{remarks,jdbcType=VARCHAR},
		#{createTime,jdbcType=VARCHAR},
		#{createUser,jdbcType=INTEGER}, #{updateTime,jdbcType=VARCHAR},
		#{updateUser,jdbcType=INTEGER}, 0, 1)
	</insert>

	<update id="update" parameterType="com.iidooo.cms.dto.extend.CmsChannelDto">
		update IDO_CMS_CHANNEL
		set ParentID = #{parentID,jdbcType=INTEGER},
		ChannelName = #{channelName,jdbcType=VARCHAR},
		ChannelPath = #{channelPath,jdbcType=VARCHAR},
		ChannelLevel =
		#{channelLevel,jdbcType=INTEGER},
		MetaTitle = #{metaTitle,jdbcType=VARCHAR},
		MetaKeywords = #{metaKeywords,jdbcType=VARCHAR},
		MetaDescription =
		#{metaDescription,jdbcType=VARCHAR},
		Sequence = #{sequence,jdbcType=INTEGER},
		IsHidden = #{isHidden,jdbcType=CHAR},
		Remarks =
		#{remarks,jdbcType=VARCHAR},
		UpdateTime = #{updateTime,jdbcType=VARCHAR},
		UpdateUser = #{updateUser,jdbcType=INTEGER},
		Version = Version + 1
		where
		ChannelID = #{channelID,jdbcType=INTEGER}
	</update>

	<update id="deleteByPrimaryKey" parameterType="com.iidooo.cms.dto.extend.CmsChannelDto">
		update IDO_CMS_CHANNEL
		set IsDelete = 1,
		UpdateTime = #{updateTime,jdbcType=VARCHAR},
		UpdateUser =
		#{updateUser,jdbcType=INTEGER},
		Version = Version + 1
		where ChannelID = #{channelID,jdbcType=INTEGER}
	</update>
</mapper>